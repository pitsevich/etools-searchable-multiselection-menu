<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../paper-icon-button/paper-icon-button.html">

<dom-module id="deletable-option-list">
    <template>
        <style>
            :host {
            }

            span {
                display: inline-block;
                width: auto;
                height: auto;
                margin-right: 8px;
                font-size: 16px;
                line-height: 24px;
                color: var(--esmm-option-list-color, #212121);
            }

            span.placeholder {
                color: rgba(0,0,0,.54);
            }

            paper-icon-button {
                color: red;
                opacity: 0.54;
                padding: 0;
                height: 18px;
                width: 18px;
            }

            .custom-input {
                height: 24px;
            }

            *[hidden] {
                display: none;
            }
        </style>

        <div class="paper-input-input custom-input">

            <template is="dom-if" if="[[_showPlaceHolder(optionValue)]]">
                <span class="placeholder">[[placeholder]]</span>
            </template>

            <template is="dom-repeat" items="[[optionValue]]">
                <span>
                    {{item.label}}
                    <paper-icon-button hidden$="[[disabled]]" icon="close" on-click="_fireClose"></paper-icon-button>
                </span>
            </template>
        </div>


    </template>

    <script>
        Polymer({
            is: 'deletable-option-list',

            properties: {
                placeholder: String,
                optionValue: {
                    type: Array,
                    value: [],
                    notify: true
                },
                disabled: {
                    type: Boolean,
                    value: false
                }
            },

            _showPlaceHolder: function(optionValue) {
                return !optionValue || !optionValue.length;
            },

            _fireClose: function(e) {
                if(this.disabled) {
                    return;
                }
                var details = e.model.item;
                var newValue = this.optionValue.filter(function(item) {
                    return parseInt(item.value, 10) !== parseInt(details.value, 10)
                });
                newValue = newValue.length > 0 ? newValue : null;
                this.set('optionValue', newValue);
                this.fire('option-delete', details);
            },
        });
    </script>
</dom-module>